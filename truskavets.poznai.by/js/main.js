class Preloader{constructor(){this.container=document.querySelector("#preloader"),this.init()}init(){window.addEventListener("load",(()=>{this.container.classList.add("remove-preloader"),setTimeout(()=>{this.container.parentNode.removeChild(this.container)},400)}).bind(this))}}class FilterNavActive{constructor(t,e,i){this.container=document.querySelector(t),this.callBack=i,this.init(e)}init(t){this.items=this.container.querySelectorAll(t);for(let t=0;t<this.items.length;t++)this.initClick(this.items[t])}initClick(t){t.addEventListener("click",e=>{this.removeActive(),this.addActive(t),this.callBack&&this.callBack()})}removeActive(){for(let t=0;t<this.items.length;t++)this.items[t].classList.contains("active")&&this.items[t].classList.remove("active")}addActive(t){t.classList.contains("active")||t.classList.add("active")}}class PriceRooms{constructor(t){this.getElements(t)}getElements(t){this.container=document.querySelector(t),this.table=this.container.querySelector(".rooms-price-table"),this.dayBtn9=this.container.querySelector("#dayBtn9"),this.dayBtn8=this.container.querySelector("#dayBtn8"),this.dropDown9=this.container.querySelector("#dropDown9"),this.dropDown8=this.container.querySelector("#dropDown8"),this.getDollar(),this.getRooms(),this.getMenu(),this.insertFirstDate()}getDollar(){let t=this.container.querySelector("#dolarContainer");this.dolar=Number(t.dataset.dolar)}getRooms(){this.room9days=this.container.querySelectorAll(".room9day"),this.room8days=this.container.querySelectorAll(".room8day")}getMenu(){this.day9Items=this.dropDown9.querySelectorAll(".dropdown-item"),this.day8Items=this.dropDown8.querySelectorAll(".dropdown-item"),this.initChangeItem()}initChangeItem(){for(let t=0;t<this.day9Items.length;t++)this.day9Items[t].addEventListener("click",this.changePrice.bind(this,"room9",this.day9Items[t])),this.day9Items[t].addEventListener("mouseover",(e=>{this.checkEvent(this.day9Items[t])}).bind(this));for(let t=0;t<this.day8Items.length;t++)this.day8Items[t].addEventListener("click",this.changePrice.bind(this,"room8",this.day8Items[t])),this.day8Items[t].addEventListener("mouseover",(e=>{this.checkEvent(this.day8Items[t])}).bind(this))}changePrice(t,e){let i=Number(e.dataset["1room"]),s=Number(e.dataset["2lux"]),r=Number(e.dataset["2room"]),a=Number(e.dataset["3econom"]),n=Number(e.dataset["4family"]),o=Number(e.dataset["23econom"]);this.changePriceTable(t,i,s,r,a,n,o),this.changeBtn(t,e.textContent)}changePriceTable(t,e,i,s,r,a,n){let o="room9"===t?this.room9days:this.room8days;for(let l=0;l<o.length;l++)o[l].classList.contains("room1")&&(o[l].innerHTML=this.around_price(e/this.dolar,t)),o[l].classList.contains("lux2")&&(o[l].innerHTML=this.around_price(i/this.dolar,t)),o[l].classList.contains("room2")&&(o[l].innerHTML=this.around_price(s/this.dolar,t)),o[l].classList.contains("econom3")&&(o[l].innerHTML=this.around_price(r/this.dolar,t)),o[l].classList.contains("family4")&&(o[l].innerHTML=this.around_price(a/this.dolar,t)),o[l].classList.contains("econom23")&&(o[l].innerHTML=this.around_price(n/this.dolar,t))}around_price(t,e){return"room8"===e?Math.round(t):Math.round(t)+5}changeBtn(t,e){("room9"===t?this.dayBtn9:this.dayBtn8).innerHTML=e}checkEvent(t){t.dataset.offer&&$(t).popover({animation:!0,content:t.dataset.offer,title:"Специальное предложение!",trigger:"hover"})}insertFirstDate(){this.dayBtn9.innerHTML=this.day9Items[0].textContent,this.dayBtn8.innerHTML=this.day8Items[0].textContent,this.changePrice("room9",this.day9Items[0]),this.changePrice("room8",this.day8Items[0])}}class LandPageMenu{constructor(t,e){this.calcMargin(e,t),this.init(t)}calcMargin(t,e){if(t)this.margin=t;else{let t=document.querySelector(e);this.margin=t.offsetHeight+10}}init(t){this.selector=t,window.addEventListener("load",(()=>{this.getNavElements(),this.getSections(),this.initActive(),this.initNav()}).bind(this))}initNav(){this.navItems.forEach((t,e)=>{t.addEventListener("click",((t,e)=>{e.preventDefault(),window.scrollTo(0,this.sections[t]-this.margin)}).bind(this,e))})}getNavElements(){this.container=document.querySelector(this.selector),this.navItems=this.container.querySelectorAll(".nav-land")}getSections(){this.sections=[];for(let t=0;t<this.navItems.length;t++){let e=this.navItems[t].dataset.menu,i=document.querySelector("#"+e);i&&this.sections.push(i.getBoundingClientRect().top+window.scrollY)}}initActive(){this.calcNextStep(),window.addEventListener("scroll",this.calcNextStep.bind(this))}calcNextStep(){for(let t=0;t<this.sections.length;t++)if(!(window.pageYOffset>=this.sections[t]+this.margin+10&&this.sections[t+1])||window.pageYOffset<this.sections[t+1]-this.margin-10)return void this.changeActive(t)}changeActive(t){this.navItems.forEach(t=>{t.classList.contains("active")&&t.classList.remove("active")}),this.navItems[t].classList.contains("active")||this.navItems[t].classList.add("active")}}class ProgramDays{constructor(t,e,i,s){this.container=document.querySelector(t),this.path=e,this.type=i,this.url=s,this.http=new XMLHttpRequest,this.init()}init(){this.sendRequest().then(this.writeDates.bind(this))}writeDates(t){this.dates=JSON.parse(t),"single"===this.type&&this.initSingleProgram(),"modal"===this.type&&(this.getModal(),this.createModalRow())}getModal(){this.modal={},this.modal.container=document.querySelector("#modalProgram"),this.modal.title=this.modal.container.querySelector(".day-number"),this.modal.carousel=this.modal.container.querySelector(".modal-carousel"),this.modal.programTitle=this.modal.container.querySelector(".modal-program-title"),this.modal.programContent=this.modal.container.querySelector(".modal-program-content")}createModalRow(){let t=document.createElement("div");t.className="slider-program-row",t.appendChild(this.createDayTitle(this.stripTags(this.dates.title)));let e=document.createElement("div");e.className="owl-carousel owl-theme",e.id="modalProgramSlider",this.dates.program.forEach((t,i)=>e.appendChild(this.createCardSlider(t,i))),this.initCardCarousel(e),t.appendChild(e),this.container.appendChild(t)}createCardSlider(t,e){let i=document.createElement("div");return i.className="program-card item",i.setAttribute("style","background-image: url('"+this.url+this.createPath(t.imgPath)+t.img[0]+"');"),i.appendChild(this.createCardTitleDesc(this.stripTags(t.desc),this.stripTags(t.name))),this.initCardModal(i,e),i}createCardImg(t){let e=new Image;return e.src=t,e}createCardTitleDesc(t,e){let i=document.createElement("div");i.className="car-content-wrap";let s=document.createElement("h6");return s.className="card-title",s.innerHTML=e,i.appendChild(s),i.appendChild(this.createCardContent(t)),i}createCardContent(t){let e=t.length>200?t.substring(0,197)+"...":t,i=document.createElement("p");return i.className="card-content",i.innerHTML=e,i}initCardModal(t,e){t.addEventListener("click",t=>{let i=this.dates.program[Number(e)];this.modal.title.innerHTML=this.stripTags(this.dates.title),this.modal.programTitle.innerHTML=this.stripTags(i.name),this.modal.programContent.innerHTML=this.stripTags(i.desc),this.modal.carousel.innerHTML="";let s=this.createPath(i.imgPath),r=document.createElement("div");if(r.className="owl-carousel",i.img.forEach(t=>r.appendChild(this.createCarouselItem(this.url+s+t))),this.modal.carousel.querySelector(".owl-carousel")){let t=this.modal.querySelector(".owl-carousel");t.parentNode.removeChild(t)}this.modal.carousel.appendChild(r),this.initCarousel(r),$(this.modal.container).modal("show")})}initSingleProgram(){let t=[],e=this.dates.program[0].imgPath;this.dates.program[0].img.forEach(i=>t.push(this.url+this.createPath(e)+i)),this.container.appendChild(this.createSingleProgram(this.stripTags(this.dates.title),this.stripTags(this.dates.program[0].name),t,this.stripTags(this.dates.program[0].desc)))}createSingleProgram(t,e,i,s){let r=document.createElement("div");r.className="day-program-wrapper";let a=this.createDayTitle(t),n=document.createElement("div");n.classList="single-program-row";let o=this.createCarousel(i);this.initCarousel(o);let l=this.createSingleProgramContent(e,s);return n.appendChild(o),n.appendChild(l),r.appendChild(a),r.appendChild(n),r}createDayTitle(t){let e=document.createElement("h5");return e.className="day-program-title",e.innerHTML=t,e}createCarousel(t){let e=document.createElement("div");return e.className="owl-carousel owl-theme aos-el",e.setAttribute("data-aos","fade-right"),e.id="#singleProgramCarousel",t.forEach(t=>e.appendChild(this.createCarouselItem(t))),e}createCarouselItem(t){let e=document.createElement("div");return e.className="item",e.setAttribute("style","background-image: url('"+t+"')"),e}createSingleProgramContent(t,e){let i=document.createElement("div");return i.className="single-program-content mCustomScrollbar aos-wrap",i.setAttribute("data-mcs-theme","dark"),i.setAttribute("data-aos","fade-left"),i.appendChild(this.createProgramSingleTitle(t)),i.appendChild(this.createProgramSingleContent(e)),i}createProgramSingleTitle(t){let e=document.createElement("h6");return e.className="program-single-title",e.innerHTML=t,e}createProgramSingleContent(t){let e=document.createElement("p");return e.className="porgram-single-text",e.innerHTML=t,e}destroyCarousel(t){$(t).trigger("remove.owl.carousel")}initCarousel(t){$(t).owlCarousel({nav:!1,slideSpeed:300,paginationSpeed:300,items:1,autoplay:!0,loop:!0})}initCardCarousel(t){$(t).owlCarousel({nav:!0,slideSpeed:300,paginationSpeed:400,items:1,autoplay:!1,loop:!0,margin:20,autoplayHoverPause:!0,responsiveClass:!0,mouseDrag:!1,responsive:{600:{items:2,margin:30},1000:{items:3,margin:10},1400:{items:3,margin:30}}})}createPath(t){return t.replace(/\s/g,"").split("/").filter(t=>t).join("/")+"/"}stripTags(t){let e=document.createElement("div");return e.innerHTML=t,e.textContent}sendRequest(t){return this.http.open("GET",this.url+"includes/request.php?action=get_program&path="+encodeURIComponent(this.path)),this.http.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.http.send(),new Promise(this.getDates.bind(this))}getDates(t,e){this.http.onreadystatechange=(()=>{4===this.http.readyState&&200===this.http.status&&t(this.http.responseText)})}}class Contact{constructor(t){this.initSet(t),this.http=new XMLHttpRequest,this.init()}initSet(t){this.url=t.url,this.container=document.querySelector(t.container),this.input=[],t.input.forEach(t=>this.input.push(this.container.querySelector("#"+t))),this.sendBtn=this.container.querySelector(t.submit)}init(){this.sendBtn.addEventListener("click",t=>{this.checkInput()&&(this.confirmSendMsg(),this.sendRequest())})}checkInput(){let t=!0;return this.input.forEach(e=>{""===e.value&&(this.errorMsg(e),t=!1)}),t}errorMsg(t){t.classList.add("error-msg"),$(t).popover({animation:!0,title:"Ошибка",content:"Заполните это поле",template:'<div class="popover error" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),$(t).popover("show"),this.removeError(t)}removeError(t){t.addEventListener("keydown",e=>{t.classList.contains("error-msg")&&t.classList.remove("error-msg"),$(t).popover("dispose")})}confirmSendMsg(){this.container.classList.add("form-confirm"),$(this.container).popover({animation:!0,title:"Ваше сообщение отправлено",content:"В ближайшее время с вами свяжется наш специалист",placement:"bottom",template:'<div class="popover confirm-send" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),$(this.container).popover("show"),setTimeout(()=>{$(this.container).popover("dispose"),this.container.classList.remove("form-confirm")},5e3)}sendRequest(){let t={};this.input.forEach(e=>t[e.id]=e.value);let e="dates="+JSON.stringify(t);this.http.open("POST","includes/request.php?action=send_mail"),this.http.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.http.send(e)}}
